# IPchecker
自動でIPアドレスを取得して指定のgoogle spreadsheetに記入してくれるスクリプト

## 準備と実行手順

1. [Google Cloud Console](https://console.cloud.google.com/) にアクセスし，新しいプロジェクトを作成する．

2. 作成したプロジェクトを選択し，左側のナビゲーションメニューから「APIとサービス」 > 「ダッシュボード」に移動する．

3. 「APIとサービスを有効化」をクリックし，Google Sheets APIを検索して有効化する．

4. 左側のナビゲーションメニューから「APIとサービス」 > 「認証情報」に移動する．

5. 「認証情報を作成」をクリックし，サービスアカウントキーを作成する．
必要な情報を入力し，JSON形式でキーを作成してダウンロードする．

6. ダウンロードした認証情報のJSONファイルを保存する．

7. ターミナルを開き，以下の必要なPythonパッケージをインストールする．
    - gspread
    - oauth2client
    ```
    pip install gspread oauth2client
    ```

8. `main.py` の次の箇所を編集する．
    - 27行目を，先ほどダウンロードした認証情報のJSONを保存しているパスに置き換える．
    - 32行目に対象のスプレッドシートのurlを入力する．
    - 33行目に編集したいシート名を入力する．（初期設定なら 'シート1' ）
    - **Windowsなら39行目，Ubuntuなら40行目を使用 (使わない方はコメントアウトする)**

9. ターミナルで`main.py`を実行すると，指定したGoogleスプレッドシートのA2セルに更新時刻が，B2セルにIPアドレスが書き込まれる．


## その他
- スプレッドシートの編集者にAPIのメールアドレスを追加する必要があるかもしれない．
- cronやスケジューラなどで定期的に実行すると完全自動化する．
